<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Coding week2 6/03-6/09 | Zebin Huang | JdeRobot x GSoC2024 </title> <meta name="author" content="Zebin Huang"> <meta name="description" content="Zebin Huang | JdeRobot x GSoC2024 "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/gsoc2024-ZebinHuang/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/gsoc2024-ZebinHuang/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/gsoc2024-ZebinHuang/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/gsoc2024-ZebinHuang/assets/img/logo.png?a3cac8c2613225704682d343b37ffd84"> <link rel="stylesheet" href="/gsoc2024-ZebinHuang/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://theroboticsclub.github.io/gsoc2024-ZebinHuang/blog/2024/coding-week2-6-03-6-09/"> <script src="/gsoc2024-ZebinHuang/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/gsoc2024-ZebinHuang/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/gsoc2024-ZebinHuang/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/gsoc2024-ZebinHuang/assets/js/distillpub/template.v2.js"></script> <script src="/gsoc2024-ZebinHuang/assets/js/distillpub/transforms.v2.js"></script> <script src="/gsoc2024-ZebinHuang/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Coding week2 6/03-6/09",
            "description": "",
            "published": "June 24, 2024",
            "authors": [
              
              {
                "author": "Zebin Huang",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "Edinburgh Centre for Robotics",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/gsoc2024-ZebinHuang/"> Zebin Huang | JdeRobot x GSoC2024 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/gsoc2024-ZebinHuang/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/gsoc2024-ZebinHuang/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/gsoc2024-ZebinHuang/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Coding week2 6/03-6/09</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <h3 id="weekly-meeting">Weekly Meeting</h3> <p>In this week’s meeting, we reviewed our project’s current status. We analyzed the high similarity observed in the outputs generated by GPT and discussed the issues of data distribution, which led to redundancy. To address these concerns, we brainstormed strategies to enhance the diversity and balance of our dataset. Additionally, we revisited four key commands from our previous project and explored how integrating more commands could boost both functionality and efficiency. We also deliberated on setting appropriate metrics for the BERT model by segmenting the dataset into training and testing sets.</p> <p>More details can be found here: <a href="https://docs.google.com/document/d/1b2ZEU5Gt8gP2ae_YzNSJSd7RukUrsG_aDJFLnbvoQiM/edit" rel="external nofollow noopener" target="_blank">Google Doc</a></p> <h3 id="to-do-list">To-Do List</h3> <ul class="task-list"> <li class="task-list-item"> <input type="checkbox" class="task-list-item-checkbox" disabled checked>Generate scalable datasets that are intertwined with actions and commands with LLMs.</li> <li class="task-list-item"> <input type="checkbox" class="task-list-item-checkbox" disabled checked>Perform quality analyses on the generated datasets.</li> <li class="task-list-item"> <input type="checkbox" class="task-list-item-checkbox" disabled checked>Train the Bert model to classify instructions and obtain a model.</li> <li class="task-list-item"> <input type="checkbox" class="task-list-item-checkbox" disabled>Move training and test notebooks in gsoc23 to a separate script. <a href="https://github.com/TheRoboticsClub/gsoc2023-Meiqi_Zhao/issues/5" rel="external nofollow noopener" target="_blank">issue</a> </li> </ul> <h3 id="progress">Progress</h3> <p>This week, I developed a module designed to generate user-driving instructions using GPT. The code focuses on creating prompts based on predefined templates and user inputs, with an emphasis on improving the logic for prompt creation to enhance clarity and engagement. Additionally, the module includes features for validating user inputs and adjusting the output format accordingly. This advancement is beneficial for providing scalable instruction datasets in our project.</p> <p>The module also implements an action generation component, which formulates specific actions based on the instructions generated by GPT, such as “turn left,” “turn right,” “take exit,” “go straight,” “accelerate,” and “slow down.” Furthermore, I developed analytical tools within the prompt_analysis.py script to evaluate the effectiveness of the generated instructions, incorporating metrics to assess their relevance. Lastly, I implemented training using the BERT model to further enhance the module’s performance.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python train.py
1000 1000
Labels length: 1000
Input IDs length: 1000
Attention Mask length: 1000
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: <span class="o">[</span><span class="s1">'classifier.bias'</span>, <span class="s1">'classifier.weight'</span><span class="o">]</span>
You should probably TRAIN this model on a down-stream task to be able to use it <span class="k">for </span>predictions and inference.
<span class="o">{</span><span class="s1">'loss'</span>: 1.697, <span class="s1">'grad_norm'</span>: 19.306570053100586, <span class="s1">'learning_rate'</span>: 1.0000000000000002e-06, <span class="s1">'epoch'</span>: 0.09<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 1.617, <span class="s1">'grad_norm'</span>: 13.708064079284668, <span class="s1">'learning_rate'</span>: 2.0000000000000003e-06, <span class="s1">'epoch'</span>: 0.18<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 1.4665, <span class="s1">'grad_norm'</span>: 9.595329284667969, <span class="s1">'learning_rate'</span>: 3e-06, <span class="s1">'epoch'</span>: 0.27<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 1.2224, <span class="s1">'grad_norm'</span>: 12.889700889587402, <span class="s1">'learning_rate'</span>: 4.000000000000001e-06, <span class="s1">'epoch'</span>: 0.35<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 1.0262, <span class="s1">'grad_norm'</span>: 10.967733383178711, <span class="s1">'learning_rate'</span>: 5e-06, <span class="s1">'epoch'</span>: 0.44<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.7739, <span class="s1">'grad_norm'</span>: 13.827258110046387, <span class="s1">'learning_rate'</span>: 6e-06, <span class="s1">'epoch'</span>: 0.53<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.7852, <span class="s1">'grad_norm'</span>: 5.5881853103637695, <span class="s1">'learning_rate'</span>: 7.000000000000001e-06, <span class="s1">'epoch'</span>: 0.62<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.6525, <span class="s1">'grad_norm'</span>: 8.820500373840332, <span class="s1">'learning_rate'</span>: 8.000000000000001e-06, <span class="s1">'epoch'</span>: 0.71<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3866, <span class="s1">'grad_norm'</span>: 4.9470295906066895, <span class="s1">'learning_rate'</span>: 9e-06, <span class="s1">'epoch'</span>: 0.8<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3203, <span class="s1">'grad_norm'</span>: 3.308020830154419, <span class="s1">'learning_rate'</span>: 1e-05, <span class="s1">'epoch'</span>: 0.88<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3612, <span class="s1">'grad_norm'</span>: 9.319038391113281, <span class="s1">'learning_rate'</span>: 1.1000000000000001e-05, <span class="s1">'epoch'</span>: 0.97<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3051, <span class="s1">'grad_norm'</span>: 8.626148223876953, <span class="s1">'learning_rate'</span>: 1.2e-05, <span class="s1">'epoch'</span>: 1.06<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3143, <span class="s1">'grad_norm'</span>: 4.779806613922119, <span class="s1">'learning_rate'</span>: 1.3000000000000001e-05, <span class="s1">'epoch'</span>: 1.15<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2742, <span class="s1">'grad_norm'</span>: 8.452868461608887, <span class="s1">'learning_rate'</span>: 1.4000000000000001e-05, <span class="s1">'epoch'</span>: 1.24<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3953, <span class="s1">'grad_norm'</span>: 3.7451024055480957, <span class="s1">'learning_rate'</span>: 1.5e-05, <span class="s1">'epoch'</span>: 1.33<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2989, <span class="s1">'grad_norm'</span>: 0.8715028762817383, <span class="s1">'learning_rate'</span>: 1.6000000000000003e-05, <span class="s1">'epoch'</span>: 1.42<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.3149, <span class="s1">'grad_norm'</span>: 9.316072463989258, <span class="s1">'learning_rate'</span>: 1.7000000000000003e-05, <span class="s1">'epoch'</span>: 1.5<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1399, <span class="s1">'grad_norm'</span>: 8.054197311401367, <span class="s1">'learning_rate'</span>: 1.8e-05, <span class="s1">'epoch'</span>: 1.59<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.246, <span class="s1">'grad_norm'</span>: 7.560857772827148, <span class="s1">'learning_rate'</span>: 1.9e-05, <span class="s1">'epoch'</span>: 1.68<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.151, <span class="s1">'grad_norm'</span>: 0.3591634929180145, <span class="s1">'learning_rate'</span>: 2e-05, <span class="s1">'epoch'</span>: 1.77<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1007, <span class="s1">'grad_norm'</span>: 7.88149881362915, <span class="s1">'learning_rate'</span>: 2.1e-05, <span class="s1">'epoch'</span>: 1.86<span class="o">}</span>
 63%|█████████████████████████████████████████████████████████████████████████████████▏                                              | 215/33 64%|████████████████████████████████████████████████████████████████▉                                     | 216/339 <span class="o">[</span>00:55&lt;00:31,  3.93it/s]<span class="o">{</span><span class="s1">'loss'</span>: 0.1223, <span class="s1">'grad_norm'</span>: 1.4635449647903442, <span class="s1">'learning_rate'</span>: 2.2000000000000003e-05, <span class="s1">'epoch'</span>: 1.95<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1039, <span class="s1">'grad_norm'</span>: 17.848655700683594, <span class="s1">'learning_rate'</span>: 2.3000000000000003e-05, <span class="s1">'epoch'</span>: 2.04<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2297, <span class="s1">'grad_norm'</span>: 0.22711549699306488, <span class="s1">'learning_rate'</span>: 2.4e-05, <span class="s1">'epoch'</span>: 2.12<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2394, <span class="s1">'grad_norm'</span>: 0.3263954222202301, <span class="s1">'learning_rate'</span>: 2.5e-05, <span class="s1">'epoch'</span>: 2.21<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2566, <span class="s1">'grad_norm'</span>: 0.4583888351917267, <span class="s1">'learning_rate'</span>: 2.6000000000000002e-05, <span class="s1">'epoch'</span>: 2.3<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1733, <span class="s1">'grad_norm'</span>: 0.12949731945991516, <span class="s1">'learning_rate'</span>: 2.7000000000000002e-05, <span class="s1">'epoch'</span>: 2.39<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1403, <span class="s1">'grad_norm'</span>: 0.12070054560899734, <span class="s1">'learning_rate'</span>: 2.8000000000000003e-05, <span class="s1">'epoch'</span>: 2.48<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2578, <span class="s1">'grad_norm'</span>: 0.15354938805103302, <span class="s1">'learning_rate'</span>: 2.9e-05, <span class="s1">'epoch'</span>: 2.57<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1055, <span class="s1">'grad_norm'</span>: 0.30441755056381226, <span class="s1">'learning_rate'</span>: 3e-05, <span class="s1">'epoch'</span>: 2.65<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2079, <span class="s1">'grad_norm'</span>: 16.82185935974121, <span class="s1">'learning_rate'</span>: 3.1e-05, <span class="s1">'epoch'</span>: 2.74<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.2025, <span class="s1">'grad_norm'</span>: 4.622957229614258, <span class="s1">'learning_rate'</span>: 3.2000000000000005e-05, <span class="s1">'epoch'</span>: 2.83<span class="o">}</span>
<span class="o">{</span><span class="s1">'loss'</span>: 0.1915, <span class="s1">'grad_norm'</span>: 18.763633728027344, <span class="s1">'learning_rate'</span>: 3.3e-05, <span class="s1">'epoch'</span>: 2.92<span class="o">}</span>
<span class="o">{</span><span class="s1">'train_runtime'</span>: 84.7519, <span class="s1">'train_samples_per_second'</span>: 31.858, <span class="s1">'train_steps_per_second'</span>: 4.0, <span class="s1">'train_loss'</span>: 0.45582248397984687, <span class="s1">'epoch'</span>: 3.0<span class="o">}</span>
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 339/339 <span class="o">[</span>01:24&lt;00:00,  4.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 <span class="o">[</span>00:00&lt;00:00, 11.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 <span class="o">[</span>00:00&lt;00:00, 11.14it/s]
              precision    recall  f1-score   support

           0       0.99      0.96      0.97        89
           1       0.71      0.91      0.80        11

    accuracy                           0.95       100
   macro avg       0.85      0.93      0.89       100
weighted avg       0.96      0.95      0.95       100
</code></pre></div></div> <h3 id="challenges">Challenges</h3> <p>During the data generation process, I encountered a significant issue with data imbalance. By using GPT to generate 1000 data points, I discovered that the distribution of the data was uneven, as illustrated below:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/gsoc2024-ZebinHuang/assets/img/wordcloud-480.webp 480w,/gsoc2024-ZebinHuang/assets/img/wordcloud-800.webp 800w,/gsoc2024-ZebinHuang/assets/img/wordcloud-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/gsoc2024-ZebinHuang/assets/img/wordcloud.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset="/gsoc2024-ZebinHuang/assets/img/datasets-480.webp 480w,/gsoc2024-ZebinHuang/assets/img/datasets-800.webp 800w,/gsoc2024-ZebinHuang/assets/img/datasets-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/gsoc2024-ZebinHuang/assets/img/datasets.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset="/gsoc2024-ZebinHuang/assets/img/distribution-480.webp 480w,/gsoc2024-ZebinHuang/assets/img/distribution-800.webp 800w,/gsoc2024-ZebinHuang/assets/img/distribution-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/gsoc2024-ZebinHuang/assets/img/distribution.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>From the database analysis, we observed an increased presence of data duplicates, such as the instruction “Approaching the roundabout.” Consequently, the model’s interpretation of this instruction has predominantly skewed towards “take exit.” This repetition is also evident in the word cloud, where several words appear repeatedly. This issue results in an unbalanced distribution of data, which affects the model’s performance and accuracy in understanding diverse driving instructions.</p> <p>Although the BERT model achieved satisfactory accuracy, the skewed data distribution poses challenges for real-world application. The model’s performance might not generalize well to new, unseen data if it does not reflect a balanced representation of all possible scenarios. This imbalance could lead to biased predictions and reduced effectiveness in practical use cases. Addressing this challenge will be crucial to ensure the robustness and reliability of the instructional generation system. Potential solutions include augmenting the dataset to ensure balance or applying bias correction methods during the model training phase.</p> <h3 id="future-tasks">Future Tasks</h3> <ul> <li>Continue refining the data balancing strategies to further improve the diversity of generated outputs.</li> <li>Complete the integration and testing of additional commands from previous projects.</li> <li>Optimize the model training process and evaluate the effectiveness of the dataset division.</li> </ul> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/gsoc2024-ZebinHuang/assets/bibliography/posts.bib"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Zebin Huang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="/gsoc2024-ZebinHuang/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>